{
  "version": 4,
  "terraform_version": "0.12.7",
  "serial": 3,
  "lineage": "39a7aa63-99a6-c0b6-3812-7777b5b6b266",
  "outputs": {
    "policy": {
      "value": {
        "additional_domains": [],
        "cname": "web0-block-ocitutorials-tk.b.waas.oci.oraclecloud.net",
        "compartment_id": "ocid1.compartment.oc1..aaaaaaaap7zxffy5cadhxdn363f6up4wnf5y2s7frdx5i7ecv6npdvsnrkra",
        "defined_tags": {
          "basic.created_by": "mmarukaw (user)",
          "basic.owner": "masataka.marukawa",
          "organization.fy20_level_1": "staketsu_org",
          "organization.fy20_level_2": "skuroda_org"
        },
        "display_name": "web0",
        "domain": "web0.block.ocitutorials.tk",
        "freeform_tags": {},
        "id": "ocid1.waaspolicy.oc1..aaaaaaaa2jo4a3big3r2vkxos5zqbghau3lcffmjb6y3wy4des2cfyblg2kq",
        "origin_groups": [],
        "origins": [
          {
            "custom_headers": [
              {
                "name": "undefined",
                "value": "undefined"
              }
            ],
            "http_port": 80,
            "https_port": 443,
            "label": "web0.block.ocitutorials.tk",
            "uri": "1.2.3.4"
          }
        ],
        "policy_config": [
          {
            "certificate_id": "",
            "cipher_group": "",
            "client_address_header": "",
            "is_behind_cdn": false,
            "is_cache_control_respected": false,
            "is_https_enabled": false,
            "is_https_forced": false,
            "is_origin_compression_enabled": false,
            "is_response_buffering_enabled": false,
            "tls_protocols": []
          }
        ],
        "state": "ACTIVE",
        "time_created": "2019-10-17 08:51:51.028 +0000 UTC",
        "waas_policy_id": "ocid1.waaspolicy.oc1..aaaaaaaa2jo4a3big3r2vkxos5zqbghau3lcffmjb6y3wy4des2cfyblg2kq",
        "waf_config": [
          {
            "access_rules": [],
            "address_rate_limiting": [
              {
                "allowed_rate_per_address": 1,
                "block_response_code": 503,
                "is_enabled": false,
                "max_delayed_count_per_address": 10
              }
            ],
            "caching_rules": [],
            "captchas": [
              {
                "failure_message": "CAPTCHAが正しくありませんでした。再試行してください。",
                "footer_text": "上のイメージに表示されている文字と数字を入力してください。",
                "header_text": "このWebサイトへのアクセスの試行回数が増加していることが検出されました。このサイトの安全を維持できるように、次のイメージのテキストを入力して、あなたがロボットではないことを示してください。",
                "session_expiration_in_seconds": 300,
                "submit_label": "はい、私は人間です。",
                "title": "あなたは人間ですか。",
                "url": "/captcha"
              }
            ],
            "custom_protection_rules": [],
            "device_fingerprint_challenge": [
              {
                "action": "DETECT",
                "action_expiration_in_seconds": 60,
                "challenge_settings": [
                  {
                    "block_action": "SHOW_ERROR_PAGE",
                    "block_error_page_code": "DFC",
                    "block_error_page_description": "Access blocked by website owner. Please contact support.",
                    "block_error_page_message": "Access to the website is blocked.",
                    "block_response_code": 403,
                    "captcha_footer": "Enter the letters and numbers as they are shown in image above.",
                    "captcha_header": "We have detected an increased number of attempts to access this website. To help us keep this site secure, please let us know that you are not a robot by entering the text from the image below.",
                    "captcha_submit_label": "Yes, I am human.",
                    "captcha_title": "Are you human?"
                  }
                ],
                "failure_threshold": 10,
                "failure_threshold_expiration_in_seconds": 60,
                "is_enabled": false,
                "max_address_count": 20,
                "max_address_count_expiration_in_seconds": 60
              }
            ],
            "human_interaction_challenge": [
              {
                "action": "DETECT",
                "action_expiration_in_seconds": 60,
                "challenge_settings": [
                  {
                    "block_action": "SHOW_ERROR_PAGE",
                    "block_error_page_code": "HIC",
                    "block_error_page_description": "Access blocked by website owner. Please contact support.",
                    "block_error_page_message": "Access to the website is blocked.",
                    "block_response_code": 403,
                    "captcha_footer": "Enter the letters and numbers as they are shown in image above.",
                    "captcha_header": "We have detected an increased number of attempts to access this website. To help us keep this site secure, please let us know that you are not a robot by entering the text from the image below.",
                    "captcha_submit_label": "Yes, I am human.",
                    "captcha_title": "Are you human?"
                  }
                ],
                "failure_threshold": 10,
                "failure_threshold_expiration_in_seconds": 60,
                "interaction_threshold": 3,
                "is_enabled": false,
                "recording_period_in_seconds": 15,
                "set_http_header": []
              }
            ],
            "js_challenge": [
              {
                "action": "BLOCK",
                "action_expiration_in_seconds": 60,
                "challenge_settings": [
                  {
                    "block_action": "SHOW_ERROR_PAGE",
                    "block_error_page_code": "JSC-403",
                    "block_error_page_description": "Access blocked by website owner. Please contact support.",
                    "block_error_page_message": "Access to the website is blocked.",
                    "block_response_code": 403,
                    "captcha_footer": "Enter the letters and numbers as they are shown in image above.",
                    "captcha_header": "We have detected an increased number of attempts to access this website. To help us keep this site secure, please let us know that you are not a robot by entering the text from the image below.",
                    "captcha_submit_label": "Yes, I am human.",
                    "captcha_title": "Are you human?"
                  }
                ],
                "failure_threshold": 10,
                "is_enabled": true,
                "set_http_header": [
                  {
                    "name": "x-jsc-alerts",
                    "value": "{failed_amount}"
                  }
                ]
              }
            ],
            "origin": "web0.block.ocitutorials.tk",
            "origin_groups": [],
            "protection_settings": [
              {
                "allowed_http_methods": [
                  "GET",
                  "POST",
                  "HEAD",
                  "OPTIONS"
                ],
                "block_action": "SET_RESPONSE_CODE",
                "block_error_page_code": "403",
                "block_error_page_description": "Access blocked by website owner. Please contact support.",
                "block_error_page_message": "Access to the website is blocked.",
                "block_response_code": 403,
                "is_response_inspected": false,
                "max_argument_count": 255,
                "max_name_length_per_argument": 400,
                "max_response_size_in_ki_b": 1024,
                "max_total_name_length_of_arguments": 64000,
                "media_types": [
                  "text/html",
                  "text/plain"
                ],
                "recommendations_period_in_days": 10
              }
            ],
            "whitelists": []
          }
        ]
      },
      "type": [
        "object",
        {
          "additional_domains": [
            "list",
            "string"
          ],
          "cname": "string",
          "compartment_id": "string",
          "defined_tags": [
            "map",
            "string"
          ],
          "display_name": "string",
          "domain": "string",
          "freeform_tags": [
            "map",
            "string"
          ],
          "id": "string",
          "origin_groups": [
            "list",
            [
              "object",
              {
                "label": "string",
                "origin_group": [
                  "list",
                  [
                    "object",
                    {
                      "origin": "string",
                      "weight": "number"
                    }
                  ]
                ]
              }
            ]
          ],
          "origins": [
            "list",
            [
              "object",
              {
                "custom_headers": [
                  "list",
                  [
                    "object",
                    {
                      "name": "string",
                      "value": "string"
                    }
                  ]
                ],
                "http_port": "number",
                "https_port": "number",
                "label": "string",
                "uri": "string"
              }
            ]
          ],
          "policy_config": [
            "list",
            [
              "object",
              {
                "certificate_id": "string",
                "cipher_group": "string",
                "client_address_header": "string",
                "is_behind_cdn": "bool",
                "is_cache_control_respected": "bool",
                "is_https_enabled": "bool",
                "is_https_forced": "bool",
                "is_origin_compression_enabled": "bool",
                "is_response_buffering_enabled": "bool",
                "tls_protocols": [
                  "list",
                  "string"
                ]
              }
            ]
          ],
          "state": "string",
          "time_created": "string",
          "waas_policy_id": "string",
          "waf_config": [
            "list",
            [
              "object",
              {
                "access_rules": [
                  "list",
                  [
                    "object",
                    {
                      "action": "string",
                      "block_action": "string",
                      "block_error_page_code": "string",
                      "block_error_page_description": "string",
                      "block_error_page_message": "string",
                      "block_response_code": "number",
                      "bypass_challenges": [
                        "list",
                        "string"
                      ],
                      "criteria": [
                        "list",
                        [
                          "object",
                          {
                            "condition": "string",
                            "value": "string"
                          }
                        ]
                      ],
                      "name": "string",
                      "redirect_response_code": "string",
                      "redirect_url": "string"
                    }
                  ]
                ],
                "address_rate_limiting": [
                  "list",
                  [
                    "object",
                    {
                      "allowed_rate_per_address": "number",
                      "block_response_code": "number",
                      "is_enabled": "bool",
                      "max_delayed_count_per_address": "number"
                    }
                  ]
                ],
                "caching_rules": [
                  "list",
                  [
                    "object",
                    {
                      "action": "string",
                      "caching_duration": "string",
                      "client_caching_duration": "string",
                      "criteria": [
                        "list",
                        [
                          "object",
                          {
                            "condition": "string",
                            "value": "string"
                          }
                        ]
                      ],
                      "is_client_caching_enabled": "bool",
                      "key": "string",
                      "name": "string"
                    }
                  ]
                ],
                "captchas": [
                  "list",
                  [
                    "object",
                    {
                      "failure_message": "string",
                      "footer_text": "string",
                      "header_text": "string",
                      "session_expiration_in_seconds": "number",
                      "submit_label": "string",
                      "title": "string",
                      "url": "string"
                    }
                  ]
                ],
                "custom_protection_rules": [
                  "list",
                  [
                    "object",
                    {
                      "action": "string",
                      "id": "string"
                    }
                  ]
                ],
                "device_fingerprint_challenge": [
                  "list",
                  [
                    "object",
                    {
                      "action": "string",
                      "action_expiration_in_seconds": "number",
                      "challenge_settings": [
                        "list",
                        [
                          "object",
                          {
                            "block_action": "string",
                            "block_error_page_code": "string",
                            "block_error_page_description": "string",
                            "block_error_page_message": "string",
                            "block_response_code": "number",
                            "captcha_footer": "string",
                            "captcha_header": "string",
                            "captcha_submit_label": "string",
                            "captcha_title": "string"
                          }
                        ]
                      ],
                      "failure_threshold": "number",
                      "failure_threshold_expiration_in_seconds": "number",
                      "is_enabled": "bool",
                      "max_address_count": "number",
                      "max_address_count_expiration_in_seconds": "number"
                    }
                  ]
                ],
                "human_interaction_challenge": [
                  "list",
                  [
                    "object",
                    {
                      "action": "string",
                      "action_expiration_in_seconds": "number",
                      "challenge_settings": [
                        "list",
                        [
                          "object",
                          {
                            "block_action": "string",
                            "block_error_page_code": "string",
                            "block_error_page_description": "string",
                            "block_error_page_message": "string",
                            "block_response_code": "number",
                            "captcha_footer": "string",
                            "captcha_header": "string",
                            "captcha_submit_label": "string",
                            "captcha_title": "string"
                          }
                        ]
                      ],
                      "failure_threshold": "number",
                      "failure_threshold_expiration_in_seconds": "number",
                      "interaction_threshold": "number",
                      "is_enabled": "bool",
                      "recording_period_in_seconds": "number",
                      "set_http_header": [
                        "list",
                        [
                          "object",
                          {
                            "name": "string",
                            "value": "string"
                          }
                        ]
                      ]
                    }
                  ]
                ],
                "js_challenge": [
                  "list",
                  [
                    "object",
                    {
                      "action": "string",
                      "action_expiration_in_seconds": "number",
                      "challenge_settings": [
                        "list",
                        [
                          "object",
                          {
                            "block_action": "string",
                            "block_error_page_code": "string",
                            "block_error_page_description": "string",
                            "block_error_page_message": "string",
                            "block_response_code": "number",
                            "captcha_footer": "string",
                            "captcha_header": "string",
                            "captcha_submit_label": "string",
                            "captcha_title": "string"
                          }
                        ]
                      ],
                      "failure_threshold": "number",
                      "is_enabled": "bool",
                      "set_http_header": [
                        "list",
                        [
                          "object",
                          {
                            "name": "string",
                            "value": "string"
                          }
                        ]
                      ]
                    }
                  ]
                ],
                "origin": "string",
                "origin_groups": [
                  "list",
                  "string"
                ],
                "protection_settings": [
                  "list",
                  [
                    "object",
                    {
                      "allowed_http_methods": [
                        "list",
                        "string"
                      ],
                      "block_action": "string",
                      "block_error_page_code": "string",
                      "block_error_page_description": "string",
                      "block_error_page_message": "string",
                      "block_response_code": "number",
                      "is_response_inspected": "bool",
                      "max_argument_count": "number",
                      "max_name_length_per_argument": "number",
                      "max_response_size_in_ki_b": "number",
                      "max_total_name_length_of_arguments": "number",
                      "media_types": [
                        "list",
                        "string"
                      ],
                      "recommendations_period_in_days": "number"
                    }
                  ]
                ],
                "whitelists": [
                  "list",
                  [
                    "object",
                    {
                      "addresses": [
                        "list",
                        "string"
                      ],
                      "name": "string"
                    }
                  ]
                ]
              }
            ]
          ]
        }
      ]
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "oci_waas_waas_policy",
      "name": "waas_policy",
      "provider": "provider.oci",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "additional_domains": [],
            "cname": "web0-block-ocitutorials-tk.b.waas.oci.oraclecloud.net",
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaap7zxffy5cadhxdn363f6up4wnf5y2s7frdx5i7ecv6npdvsnrkra",
            "defined_tags": {
              "basic.created_by": "mmarukaw (user)",
              "basic.owner": "masataka.marukawa",
              "organization.fy20_level_1": "staketsu_org",
              "organization.fy20_level_2": "skuroda_org"
            },
            "display_name": "web0",
            "domain": "web0.block.ocitutorials.tk",
            "freeform_tags": {},
            "id": "ocid1.waaspolicy.oc1..aaaaaaaa2jo4a3big3r2vkxos5zqbghau3lcffmjb6y3wy4des2cfyblg2kq",
            "origin_groups": [],
            "origins": [
              {
                "custom_headers": [
                  {
                    "name": "undefined",
                    "value": "undefined"
                  }
                ],
                "http_port": 80,
                "https_port": 443,
                "label": "web0.block.ocitutorials.tk",
                "uri": "1.2.3.4"
              }
            ],
            "policy_config": [
              {
                "certificate_id": "",
                "cipher_group": "",
                "client_address_header": "",
                "is_behind_cdn": false,
                "is_cache_control_respected": false,
                "is_https_enabled": false,
                "is_https_forced": false,
                "is_origin_compression_enabled": false,
                "is_response_buffering_enabled": false,
                "tls_protocols": []
              }
            ],
            "state": "ACTIVE",
            "time_created": "2019-10-17 08:51:51.028 +0000 UTC",
            "waas_policy_id": "ocid1.waaspolicy.oc1..aaaaaaaa2jo4a3big3r2vkxos5zqbghau3lcffmjb6y3wy4des2cfyblg2kq",
            "waf_config": [
              {
                "access_rules": [],
                "address_rate_limiting": [
                  {
                    "allowed_rate_per_address": 1,
                    "block_response_code": 503,
                    "is_enabled": false,
                    "max_delayed_count_per_address": 10
                  }
                ],
                "caching_rules": [],
                "captchas": [
                  {
                    "failure_message": "CAPTCHAが正しくありませんでした。再試行してください。",
                    "footer_text": "上のイメージに表示されている文字と数字を入力してください。",
                    "header_text": "このWebサイトへのアクセスの試行回数が増加していることが検出されました。このサイトの安全を維持できるように、次のイメージのテキストを入力して、あなたがロボットではないことを示してください。",
                    "session_expiration_in_seconds": 300,
                    "submit_label": "はい、私は人間です。",
                    "title": "あなたは人間ですか。",
                    "url": "/captcha"
                  }
                ],
                "custom_protection_rules": [],
                "device_fingerprint_challenge": [
                  {
                    "action": "DETECT",
                    "action_expiration_in_seconds": 60,
                    "challenge_settings": [
                      {
                        "block_action": "SHOW_ERROR_PAGE",
                        "block_error_page_code": "DFC",
                        "block_error_page_description": "Access blocked by website owner. Please contact support.",
                        "block_error_page_message": "Access to the website is blocked.",
                        "block_response_code": 403,
                        "captcha_footer": "Enter the letters and numbers as they are shown in image above.",
                        "captcha_header": "We have detected an increased number of attempts to access this website. To help us keep this site secure, please let us know that you are not a robot by entering the text from the image below.",
                        "captcha_submit_label": "Yes, I am human.",
                        "captcha_title": "Are you human?"
                      }
                    ],
                    "failure_threshold": 10,
                    "failure_threshold_expiration_in_seconds": 60,
                    "is_enabled": false,
                    "max_address_count": 20,
                    "max_address_count_expiration_in_seconds": 60
                  }
                ],
                "human_interaction_challenge": [
                  {
                    "action": "DETECT",
                    "action_expiration_in_seconds": 60,
                    "challenge_settings": [
                      {
                        "block_action": "SHOW_ERROR_PAGE",
                        "block_error_page_code": "HIC",
                        "block_error_page_description": "Access blocked by website owner. Please contact support.",
                        "block_error_page_message": "Access to the website is blocked.",
                        "block_response_code": 403,
                        "captcha_footer": "Enter the letters and numbers as they are shown in image above.",
                        "captcha_header": "We have detected an increased number of attempts to access this website. To help us keep this site secure, please let us know that you are not a robot by entering the text from the image below.",
                        "captcha_submit_label": "Yes, I am human.",
                        "captcha_title": "Are you human?"
                      }
                    ],
                    "failure_threshold": 10,
                    "failure_threshold_expiration_in_seconds": 60,
                    "interaction_threshold": 3,
                    "is_enabled": false,
                    "recording_period_in_seconds": 15,
                    "set_http_header": []
                  }
                ],
                "js_challenge": [
                  {
                    "action": "BLOCK",
                    "action_expiration_in_seconds": 60,
                    "challenge_settings": [
                      {
                        "block_action": "SHOW_ERROR_PAGE",
                        "block_error_page_code": "JSC-403",
                        "block_error_page_description": "Access blocked by website owner. Please contact support.",
                        "block_error_page_message": "Access to the website is blocked.",
                        "block_response_code": 403,
                        "captcha_footer": "Enter the letters and numbers as they are shown in image above.",
                        "captcha_header": "We have detected an increased number of attempts to access this website. To help us keep this site secure, please let us know that you are not a robot by entering the text from the image below.",
                        "captcha_submit_label": "Yes, I am human.",
                        "captcha_title": "Are you human?"
                      }
                    ],
                    "failure_threshold": 10,
                    "is_enabled": true,
                    "set_http_header": [
                      {
                        "name": "x-jsc-alerts",
                        "value": "{failed_amount}"
                      }
                    ]
                  }
                ],
                "origin": "web0.block.ocitutorials.tk",
                "origin_groups": [],
                "protection_settings": [
                  {
                    "allowed_http_methods": [
                      "GET",
                      "POST",
                      "HEAD",
                      "OPTIONS"
                    ],
                    "block_action": "SET_RESPONSE_CODE",
                    "block_error_page_code": "403",
                    "block_error_page_description": "Access blocked by website owner. Please contact support.",
                    "block_error_page_message": "Access to the website is blocked.",
                    "block_response_code": 403,
                    "is_response_inspected": false,
                    "max_argument_count": 255,
                    "max_name_length_per_argument": 400,
                    "max_response_size_in_ki_b": 1024,
                    "max_total_name_length_of_arguments": 64000,
                    "media_types": [
                      "text/html",
                      "text/plain"
                    ],
                    "recommendations_period_in_days": 10
                  }
                ],
                "whitelists": []
              }
            ]
          }
        }
      ]
    }
  ]
}
